---
layout: 12pt
header-includes:
   - \usepackage{lineno}
   - \linenumbers
   - \usepackage{setspace}
   - \doublespacing
bibliography: ~/Dropbox/Bibliography/SageAbundance.bib
csl: components/ecology.csl

## rmarkdown render options
output:
  pdf_document:
    fig_caption: true
    keep_tex: false
fontsize: 12pt
geometry: margin=1in

---

```{r figures_source, include=FALSE, eval=FALSE}
## Source this for updated figures
source("../devel/ms_scripts.R")
```

```{r caching, include=FALSE}
library("methods")
library("knitr")
basename <- "manuscript"
opts_chunk$set(fig.path = paste("components/figure/", basename, "-", sep=""),
               cache.path = paste("components/cache/", basename, "/", sep=""))
opts_chunk$set(cache = 2)
opts_chunk$set(tidy=FALSE, warning=FALSE, message=FALSE, 
               comment = NA, verbose = TRUE, echo=FALSE)

# PDF-based figures
opts_chunk$set(dev='pdf')
```

\renewcommand*{\thefootnote}{\fnsymbol{footnote}}

\begin{centering}
\textbf{\large{A spatio-temporal modeling framework for forecasting climate change impacts on plant populations over large spatial extents}}

\textsc{\small{Andrew T. Tredennick\footnote{Corresponding author: atredenn@gmail.com}\textsuperscript{1}, Mevin B. Hooten\textsuperscript{2,3,4}, Cameron L. Aldridge\textsuperscript{5}, Collin G. Homer\textsuperscript{6}, Andrew Kleinhesselink\textsuperscript{1}, and Peter B. Adler\textsuperscript{1}}}

\textit{\small{\textsuperscript{1}Department of Wildland Resources and the Ecology Center, 5230 Old Main Hill, Utah State University, Logan, Utah 84322 USA}} \\
\textit{\small{\textsuperscript{2}U.S. Geological Survey, Colorado Cooperative Fish and Wildlife Research Unit, Colorado State University, Fort Collins, CO 80523 USA}} \\
\textit{\small{\textsuperscript{3}Department of Fish, Wildlife, and Conservation Biology, Colorado State University, Fort Collins, CO 80523 USA}} \\
\textit{\small{\textsuperscript{4}Department of Statistics, Colorado State University, Fort Collins, CO 80523 USA}} \\
\textit{\small{\textsuperscript{5}Natural Resource Ecology Laboratory and Department of Ecosystem Science and Sustainability, Colorado State University, Fort Collins, CO, in cooperation with US Geological Survey, Fort Collins Science Center, Fort Collins, CO}}\\
\textit{\small{\textsuperscript{6}U.S. Geological Survey (USGS) Earth Resources Observation and Science (EROS) Center, Sioux Falls, SD 57198 USA}}

\end{centering}

\renewcommand*{\thefootnote}{\arabic{footnote}}
\setcounter{footnote}{0}

Abstract
--------
New remote sensing technology is producing ecological data at unprecedented spatial scales. These massive data offer an opportunity to study ecological processes at the landscape and regional scales that have traditionally been observed only at the level of small study plots. However, harnessing the power of new spatial data requires statistical models that can both rigorously account for spatial autocorrelation and can also be fit within a reasonable amount of computation time. Here we demonstrate how recent advances in the modeling of animal populations can be applied to newly available remotely-sensed species-specific estimates of plant cover at the landscape scale.  We fit a spatiotemporal population model to a 27 year time series of sagebrush (*Artemisia* spp.) percent cover over a $2.5\times5$ km landscape in southwestern Wyoming. We include interannual variation in precipitation and temperature as covariates in the model to investigtate how climate affects the cover of this species. (include more on the methodological advancement/novelty.. knots etc??) We then use the model to forecast the future abudance of sagebrush at the landscape scale under projected climate change. Our analysis provides spatially explicit estimates of increases and decreases in a plant population that have, until now, been impossible to produce at this scale. (any new insights about the statistical method?) Critically our large-scale and long-term predictions are rooted in small-scale and short-term population dynamics and so serve as a useful alternative to the predictions offered by most species distribution models that do not include population dynamics at all. We expect the approach we develope here will become an indispensable method for using new remote sensing data to model how populations respond to environmental changes, especially climate change, that play out at spatial scales far greater than the average study plot. 

*Key words: population model, climate change, forecasting, spatiotemporal model, remote sensing, sagebrush*, Artemisia, *dimension reduction* 

Introduction
-------------
Forecasting the impacts of climate change on plant populations and communities is a central challenge of modern ecology [@Clark2001; @Petchey2015].
Population models are ideally suited for meeting such a challenge because they allow inference on population abundance and dynamics (year-to-year changes in abundance) in relation to climate drivers [@Hare2010; @Adler2012; @Ross2015].
However, inference from population models is typically limited to small spatial extents because the data required is difficult to collect across wide species ranges.
Indeed, almost every study of plant population dynamics relies on demographic observations recorded at the meter to sub-meter scale [see, e.g., @Salguero-Gomez2015].
Local-scale demographic data make building population projection models an easy task [@Ellner2006; @Rees2009; @Adler2012], but it is very difficult to extrapolate small-scale studies to large spatial extents with any certainty because the data likely only represent a small subset of parameter space and environmental conditions [@Freckleton2011; @Queenborough2011].
Thus, the real challenge is not to simply make population forecasts, but to do so at spatial scales relevant to policy and management decisions [@Queenborough2011, Tredennick and Adler in review].

The ideal tool for forecasting future population states under climate change would be a large-scale dynamic population model [@Schurr2012a; @Merow2014]; however, developing useful models at this scale has been limited by the lack of time series data at large spatial extents and the lack of statistical machinary needed to fit high-dimensional spatial models.
Fortunately, new advances in remote sensing and statistics now allow us to overcome both of these limitations.
First, new remote-sensing (RS) methods are now producing accurate time series of species-specific plant cover at landscape scales.  These data can be fit with dynamic population models which include yearly fluctuation in climate as covariates.
Such RS time series have revolutionized models of how climate affects ecosystem-level processes [e.g., @Running2004] and have been used to detect long term trends in plant population abundance [e.g., @Homer2015], but they have yet to be used to drive a dynamic population model.
Second, animal population modelers have developed efficient dimension reduction and reparameterization techniques that overcome the dfficulties of fitting high-dimension spatiotemporal models [see @Conn2015 for a review]. These new statistical methods have yet to be applied to RS derived plant populations data at large scales. 

Large-scale, spatially explicit population models based on RS data could offer a valuable new way to investigate the effects of large-scale environmental changes--especially climate change--playing out at landscape and regional scales.  Currently most assesments of how plant and animal populations will respond to climate change rely on Species distribution models (SDMs).  SDMs rely on static associations between contemporary climate and a species' distribution or, more rarely, abundance to project future distribution or abundance [@Elith2009] and they are easily applied at landscape to continental scales [e.g., @Maiorano2013; @Clark2014]. However, the short-term and small-scale population dynamics that actually drive the large-scale distributions of species are not represented in most SDMs. Since SDMs typically rely on occurence data, their projections of habitat suitability or probability of occurence provide little information on the future states of populations in the core of their range -- areas where a species exists now and is expected to persist in the future [add EhrlenANDMorris]. Furthermore, because they lack short-term dynamics they usually cannot produce any estimate of the rate at which local populations will increase or decrease in the near-term and instead project a future equilibrium species distribution that may or may not ever be reached within our lifetimes. Large-scale dynamic population models could overcome both of these limitations.  They would produce spatially expicit estimates of species abundance within the species range [Ehrlen and Morris] and would provide testable predictions of how populations should respond to short-term climate perturbations.  These short-term predictions would give ecological forecasters the opportunity to repeatedly validate and refine their models (cite a prediction paper).  

Sagebrush (*Artemisia tridentata*) ecosystems offer an ideal testing ground for new spatially explicit population models derived from RS data: sagebrush species are widely distributed [@Kuchler1964], sagebrush species are sensitive to climate [@Dalgleish2011; @Schlaepfer2014; @Schlaepfer2014a], new landscape and regional scale time series of sagebrush cover are now being produced from aerial imagery [@Homer2012], and forecasts of future sagebrush ecosystems are in high demand due to the precarious conservation status of the greater sage-grouse (*Centrocercus urophasianus*) [@Arnett2015].  SDMs typically predict that much of the area occupied by sagebrush ecosystems today will become unsuitable for sagebrush due to climate change, resulting in a dramatic loss in the extent of sagebrush habitat by the end of this century [@Shafer2001; @Neilson2005; @Bradley2010; @Schlaepfer2012; @Still2015]. Ecohydrology models supply a possible mechanism for sagebrush losses predicted by SDMs: climate warming could lead to earlier snowmelt, increased evaporation and ultimately less recharge of deeper soil layers in the spring [@Schlaepfer2012; @Schlaepfer2014]. In warmer parts of its range, this could be especially detrimental to sagebrush as it depends on water from deeper soil to survive and grow in this arid region [@Pechanec1937; @Schlaepfer2011; @Germino2014]. In contrast, at higher elevations and colder regions, warming and earlier snowmelt could lengthen the growing season and increase sagebrush occurrence [@Schlaepfer2012; @Schlaepfer2014]. A large-scale spatially explicit population model for sagebrush driven by interannual climate would provide a valuable new tool for assesing how sagebrush could respond to climate change in the future. 

(Direct observations of individual plants and experimental plots tend to agree with these models:  growth tends to respond negatively to spring and summer temperatures [@Miglia2005; @Poore2009; @Apodaca2013] except at higher elevations where earlier snowmelt may allow for a longer growing season [@Perfors2003; @Harte2015].) <-- Too much detail? could move to discussion or cite as evidence that "sagebrush is sensitive to climate" above?

Building on recent technological advances in spatial statistics and anticipating ever-increasing availability of RS data, we demonstrate how large-scale plant population models could be used to predict how climate change will affect sagebrush and other species in the future.  Our approach relies on a process model motivated by Gompertz density-dependent population growth and a cutting-edge remotely-sensed time series of sagebrush cover from Wyoming [@Homer2012]. We rigorously account for spatial autocorrelation with dimension reduction techniques borrowed from the animal modeling literature [@Conn2015] and produce spatially-explicit estimates of sagebrush percent cover.

The modeling framework we propose can be applied to any spatially-explicit time series of plant cover or density, but its application to remotely-sensed data products offers the largest potential.
In those cases, our approach is particularly well-suited for combining the information of population models (e.g., population status) and the spatial extent of species distribution models.

Materials and Methods
---------------------
### Data
#### Remotely-sensed time series
To demonstrate our modeling approach we use a subset of a remotely-sensed time series of sagebrush (\emph{Artemisia} spp.) shrub percent cover in Wyoming[^link0] [@Homer2012].
As part of a separate study, sagebrush percent cover was estimated using a regression tree to relate ground reflectances retrieved by three sources of optical imagery (QuickBird, Landsat, and AWiFS) to 1,780 field observations of sagebrush cover distributed across Wyoming.
The regression tree model was further validated using another 500 field observations. For Wyoming sagebrush, the model achieved an $R^{2}$ = 0.65.
To hind-cast sagebrush cover the regression tree model was applied to historical remote sensing images. 
This resulted in an annual time series of sagebrush cover at 30 meter resolution from 1984 to 2011.
In this dataset, values represent the percentage of a 30 $\times$ 30 meter pixel covered by sagebrush.
In our study, we focused on a 5,070 $\times$ 2,430 meter subset totaling 13,689 30 $\times$ 30 meter pixels each year (Figure 1).
Thus, the full dataset contains 369,603 observations consisting of 27 year-to-year transitions (27 years $\times$ 13,689 pixels).

[^link0]: *link to USGS data repo*

#### Climate covariates
Our approach is based on modeling how changes in plant populations relate to climate variables.
We downloaded daily historic weather data for our study site from the NASA Daymet data set (*available online*)[^link].
The Daymet weather data are interpolated between coarse observation units and captures some spatial variation.
We relied on weather data for the centroid of our study area.
We calculated five climate variables from the Daymet data for the time period coinciding with our remotely sensed data (1984 to 2011).

We narrowed our focus to climate covariates we know are important for sagebrush and that could be calculated from general circulation model projections.
The five climate variables in our population model are: (1) "water year" precipitation (*description*) for year \emph{t} (*lagPpt*), (2) year \emph{t} fall through summer precipitation (*ppt2*), (3) year \emph{t}-1 fall through summer precipitation (*ppt1*), (4) year \emph{t} average spring temperature (*TmeanSpr2*), and (5) year \emph{t}-1 average spring temperature (*TmeanSpr1*).
We selected these variables based on previous studies (see *Introduction*), even though not all emerge as important predictors in our model.
Several model selection techniques exist that could be applied to our approach [@Hooten2015], but we avoid model selection here to maximize focus on the general approach.

[^link]: http://daymet.ornl.gov/

To forecast future population states, we required future projections of climate for our study area.
We used the most recent climate projections used by the Intergovernmental Panel on Climate Change (IPCC), the Coupled Model Intercomparison Project 5 (CMIP5; *available online*)[^link2].
The CMIP5 provides projections from a suite of global circulations models (GCMs), and we used projections from 18 GCMs (Table A1) that produced weather projections for all three ``Representative Concentration Pathways'': RCP 4.5, RCP 6.0, and RCP 8.5 (*described online*)[^link3].
The three RCPs correspond to stabilization of radiative forcing before 2100, after 2100, and increasing greenhouse gas emissions, respectively.
To simulate equilibrium sagebrush cover under projected future climate (see below), we averaged all model projections for the centroid of our study area over the time period of 2050 to 2100.
We did the same for the time period of 1950 to 2000 so we could calculate projected changes in climate.
To keep the temporal variability from observed climate consistent for climate change scenarios, we adjusted observed climate according to projected changes.
For temperature, we subtracted the average historic (1950-2000) temperature from the average projected (2050-2100) temperature. 
For precipitation, we calculated the proportional change: we subtracted average projected (2050-2100) precipitation from average historic (1950-2000) precipitation, and then divided by average historic (1950-2000) precipitation. 
We calculate precipitation and temperature changes for RCP 4.5, RCP 6.0, and RCP 8.5 scenarios.
We implemented projected temperature and precipitation changes in the model by perturbing observed annual values by the values in Table 1.

[^link2]: http://cmip-pcmdi.llnl.gov/cmip5/
[^link3]: http://tntcat.iiasa.ac.at/RcpDb/

In another set of simulations (see below), we used yearly GCM projections from 2012 to 2098 to make temporally-explicit forecasts starting from the end point of the remotely sensed sagebrush cover data (ends in 2011). We aggregated daily GCM output for each model and RCP scenario into the yearly climate covariates used to fit our model.

### Additive spatio-temporal model for sagebrush cover
We use a descriptive model for sagebrush cover that includes additive spatial and temporal effects similar to that described by @Conn2015.
We model observed integer percent cover (*y*) in cell *i* at time *t* as conditionally Poisson

\vspace{-4em}
\begin{align}
y_{i,t} \sim \text{Poisson}(\mu_{i,t}),
\end{align}
\vspace{-4em}

where $\mu_{i,t}$ is the expected percent cover of pixel *i* in year *t*

\vspace{-4em}
\begin{align}
\text{log}(\mu_{i,t}) &= \underbrace{\beta_{0,t} + \beta_{1}y_{i,t-1}}_\text{temporal + dens. dep} + \underbrace{\textbf{x}_{t}'\boldsymbol{\gamma}}_\text{climate} + \underbrace{\eta_{i}}_\text{spatial}.
\end{align}
\vspace{-3em}

Our model of percent cover change includes a density-dependent effect of log-transformed cover in the previous year ($y_{i,t-1}$), climate effects ($\textbf{x}_t$), and a spatial random effect ($\eta$) for each pixel *i*.
Climate effects were standardized [$(x_{i}-\bar{x}) / \sigma(x)$] to improve convergence during the model fitting stage and to allow for easier prior specification.
The intercept, $\beta_{0,t}$, was allowed to vary through time so that climate variables were not over-fit.
We used a Poisson likelihood because integer percent cover values in the sagebrush data product can be considered a form of count data.
We also evaluated a negative binomial model, but found little evidence for overdispersion beyond what our model was already accomodating via the spatial random effects ($\boldsymbol{\eta}$). There was no evidence of zero-inflation in our data, but see below (*Accomodating zeros*) for how we dealt with the small number of zero percent cover observations.

Fitting the model with a spatial random effect ($\eta$) is computationally demanding when a large number of observations are considered.
This is due to the required calculations of the resulting covariance matrices, which increase as a cubic function of the number of locations [@Wikle2010].
Key to our approach is a dimension reduction strategy that greatly reduces the number of parameters needed to be estimated to account for spatial variation.
This greatly speeds up model fitting by reducing the size of the covariance matrices that need to be inverted at each MCMC iteration.
Fitting models that appropriately account for spatial autocorrelation over large spatial extents would not be feasible without these modern techniques.
We follow a common dimension reduction strategy, and express the high dimensional spatial random effect, $\boldsymbol{\eta}$, as the product of an expansion matrix, \textbf{K}, and a smaller parameter vector, $\boldsymbol{\alpha}$ [e.g., @Hooten2003; @Hooten2007a; @Conn2015].
We can then define the spatial effect as

\vspace{-4em}
\begin{align}
\boldsymbol{\eta} &= \textbf{K}\boldsymbol{\alpha}, \\
\alpha_{j} &\sim \text{Normal}(0,\sigma_{\eta}^2).
\end{align}
\vspace{-4em}

In this case, $\boldsymbol{\alpha}$ is a $m \times 1$ vector of reduced spatial random effects, and \textbf{K} is a $S \times m$ matrix that maps the reduced effects to the full \emph{S}-dimensional space, where \emph{S} is the total number of observed locations.
Thus, we are able to reduce the effective number of parameters from ${S}$ to $m$.

The last remaining obstacle is to parameterize \textbf{K}.
Here we use kernel convolution [@Barry1996; @Higdon1998] to interpolate the spatial random effect between \emph{m} "knots" that are nonrandomly distributed across the space of our study area.
This means we are modeling spatial random effects at the knot level, and we use \textbf{K} to interpolate those effects between knots.
We use an exponential kernel density to define the distance-decay function around the knots (\textbf{w}), such that the entries of \textbf{K} are

\vspace{-4em}
\begin{align}
K_{s,m} &= w_{s,m} / \sum_{s=1}^{S} w_{s,m}
\end{align}
\vspace{-4em}

where

\vspace{-4em}
\begin{align}
w_{s,m} &= \text{exp}\left(\frac{-d_{s,m}}{\sigma}\right)
\end{align}
\vspace{-4em}

where $d_{s,m}$ is the Euclidean distance between the centroid of sample cell \emph{s} and the location of knot \emph{m}, and $\sigma$ is the kernel bandwidth.
It is possible through exhaustive model selection and fitting to determine the optimal form of the kernel and to estimate optimal values for $\sigma$ [@Higdon2002; @Hooten2015].
However, given the relative size of our dataset and computational limitations, we defined kernels around 121 knots (Fig. B2) whose nearest neighbor distances are approximately equal to the range of spatial dependence in residuals from a simple GLM fit without climate covariates and the spatial random effect (Appendix B). The Bayesian posterior distribution can be expressed as

\vspace{-4em}
\begin{align}
[\boldsymbol{\beta}, \boldsymbol{\gamma}, \boldsymbol{\alpha}, \sigma_{\eta}^2 | \textbf{y}] &\propto \left( \prod_{t=1}^{T} \prod_{i=1}^{n} [y_{i,t} | \beta_{0,t}, \beta_{1}, \boldsymbol{\gamma},\boldsymbol{\alpha}] [\beta_{0,t}|\bar{\beta_{0}}, \sigma_{\beta_{0}}^2] \right) \times \\
&\left(\prod_{j=1}^{J}[\alpha_j|\sigma_{\eta}^2]\right)[\bar{\beta_{0}}][\beta_{1}][\boldsymbol{\gamma}][\sigma_{\beta_{0}}^2][\sigma_{\eta}^2].
\end{align}
\vspace{-4em}

### Accomodating zeros
Our process model (Eq. 2) includes a log transformation of the observations ($\text{log}(y_{t-1}$). 
Thus, our model does not accomodate zeros. 
Fortunately, we had very few instances where pixels went had 0% cover at time *t-1* (*N* = 47, which is 0.01% of the data set). 
Thus, we excluded those pixels from the model fitting process. 
However, when simulating the process, we needed to include possible transitions from zero to non-zero percent cover. 
We fit an intercept-only logistic model to estimate the probability of a pixel going from zero to non-zero cover

\vspace{-4em}
\begin{align}
\text{logit}(\mu_{i}) &= \alpha \\
y_{i} &\sim \text{Bernoulli}(\mu_{i})
\end{align}
\vspace{-4em}

where **y** is a vector of 0s and 1s corresponding to whether a pixel was colonized (>0% cover) or not (remains at 0% cover) and $\mu_i$ is the expected probability of colonization as a function of the mean probability of colonization ($\alpha$). 
We fit this simple model using the `lm' command in R [@R2013].  

### Computing
####Fitting the model
We fit the model in R [@R2013] using the 'No-U-Turn' Hamiltonian Monte Carlo sampler in Stan [@stan2014] and the RStan package [@rstan2014].
We obtained posterior distributions of all model parmaters from three MCMC chains comprised of 1,000 iterations each, after discarding an initial 1,000 iterations as burn in.
Such short MCMC chains may seem unusual to those more familiar with other MCMC samplers (e.g., JAGS or WinBUGS).
However, the Stan algorithm is extremely efficient, meaning that, compared to other samplers, fewer iterations are required to achieve convergence.
Each MCMC chain was initialized with unique parameter values and the model was fit in parallel using the Utah State University High-Performance Computing facility.
Model fitting required five days.
We assessed convergence visually and calculated scale reduction factors (Appendix C, $\hat{R}$ < 1.01 for all paramters) [@Gelman1992; @Gelman2009]. 

####Simulating the process
We performed four sets of simulations: (1) to compare observed and simulated equilibrium cover, (2) to compare observed and simulated year- and location-specific cover, (3) to forecast future equilibrium population states under projected climate change, and (4) to make temporally-explicit forecasts of sagebrush cover starting the final year of our observations and ending in year 2098. 
Using the posterior distribution of model parameters, we simulated a matrix of pixels equal to the size of the study area (13,689 pixels or matrix elements).
For simulations (1) and (3) we initialized all pixels with arbitrarily low cover (1%) and then projected the model forward by randomly drawing climate covariates from the observed climate time series (for 1) or a pertubed climate time series (for 3).
We ran equilibrium simulations (1 and 3) for 600 time steps and then compared the output across simulations, after discarding an initial 100 time steps.
For simulation (2), we initialized each pixel with its actual value for time *t* and cell *s* and projected the model forward one time step and compared the one-step forecast with the observed value.
For simulation (4), we initialized each pixel with the final observed value in 2011 and then projected the model forward based on GCM yearly weather projections.
We used the posterior mean of each parameter for all simulations, except for (4) where we ran 50 simulations with unique sets of parameters from the MCMC chains.
The random year effects were not used in any simulation.

Results
-------
Averaged across all GCMs, precipitation and temperature in our study area are projected to increase by 2050-2100 relative to observed climate from 1950-2000, with the magnitude depending on the RCP scenario (Table 1). Trajectories of our climate covariates from GCM projections, used to make yearly forecasts, show similar trends (Fig. 2). GCM projections are variable for our study area, highlighting the importance of making forecasts based on ensemble projections.

All parameters in our model converged on stable posterior distributions (Appendix X).
Only the *lagPpt* climate covariate can be considered important based on a 90% credible interval, and it had a positive effect on sagebrush annual percent cover change (Fig. 3).
The posterior mean for the spatial random effect, $\boldsymbol{\eta}$, captured the overall spatial structure of the observed data (Fig. X#).
This indicates our choice of knot placement and dimension reduction strategy was adequate for describing permanent spatial variation in the data.

When we simulated the pixel-based population model based on observed climate it was able to reproduce average observed percent cover in space (Fig. 4A,B).
Our model shows a tendency to underpredict perennially-low percent cover pixels (Fig. 4C), but does a better job at predicting high cover pixels.
Nonetheless, observations and predictions are qualitatively similar (Fig. 4A, B).
Point predictions are most confident, though slightly biased, in low percent cover pixels (Fig. 4D).
The model is also able to adequately reproduce observed dynamics when we make one-step-ahead predictions based on observed climate and cover in the previous year for each pixel.
When we made these in-sample, one-step-ahead forecasts, the model achieved an RMSE = 4.31, in units of percent cover.
The correlation between observations and predictions was 0.62.


When we apply the fitted model to IPCC climate change scenarios, the model predicts gains in sagebrush percent cover, on average (Figs. 5, 6).
The spatial effect remains strong enough in low cover regions to counteract the amplifying effect of projected precipitation increases (Fig. 5).
Thus, our model predicts an increase in sagebrush cover heterogeneity because projected cover increases are smaller in low cover pixels than in high cover pixels. (Fig. 5).
For the temporally-explicit forecasts, we show spatially-averaged values and the associated uncertainty due to variability in GCM projections, variability in model parameters, and uncertainty in our process model (Fig. 6).
Based on our model and GCM projections, we forecast an average increase in sagebrush cover at our study area, but a decrease is not outside the realm of possibility (shaded regions in Fig. 6).
This result reflects the positive effect of precipitation on sagebrush cover change (Fig. 3).

Discussion
-----------
Landscape-scale population models for plant species have been elusive and challenging to implement [@Schurr2012a; @Merow2014].
Yet, the need to forecast population responses to climate change over large spatial extents is clear, as demonstrated by the wide application of species distribution models [see @Clark2014].
We introduced a new statistical approach to modeling plant populations that overcomes two major hurdles for spatially-explicit population models.
First, we used high resolution species-specific remote sensing data as a response variable.
Thus, we had a spatially-continuous data product of sagebrush abundance over a large spatial extent, meaning we could fit a model at the same spatial resolution and extent as the data. 
In so doing we, overcame a major limitation of most population models that are fit using detailed data from a single location.
Second, borrowing from new methods in spatio-temporal modeling of animal abundance [e.g., @Conn2015], we employed a dimension reduction strategy that rigorously accounted for spatial autocorrelation while also allowing for feasible computational time in model fitting.
Accounting for spatial autocorrelation in this large dataset allows for statistically rigorous inference on the effects of interannual climate on sagebrush cover change in our study region. The spatial covariance structure also provided a way to obtain spatially-explicit predictions at a resolution below that of the climate covariates (i.e. within the study region; Figs. 4,5).

The amount of precipitation in the previous year (*pptLag* in our model) emerged as a strong predictor of sagebrush cover change (Fig. 2).
Despite previous evidence that spring temperature strongly regulates population- and individual-level sagebrush performance [@Schlaepfer2012; @Schlaepfer2014], we found little evidence for a temperature effect (Fig. 2).
Our estimates for temperature effects broadly overlapped zero, but they did trend positive.
Thus, we did find some support for the idea that sagebrush will respond to positively to temperature increases in this colder part of the sagebrush range.
As seen when comparing our temporally-explicit forecasts (Fig. 6) to climate projections (Fig. 2), it also appears that our forecasts were driven by the weak, but positive, response to temperature.
Although our estimates of climate effects were small, they are in agreement with previous studies, improving our confidence that our model captured a realistic link between sagebrush growth and climate.

As expected given the relatively weak climate effects in this study area, our model projects only small changes in sagebrush cover in this area with future climate change.  Under all RCP scenarios, our model projects modest increases in sagebrush cover (Figs. 4,5).
The forecasted increases are primarily driven by a positive response to precipitation (Fig. 3), but weak effects of temperature also influenced results.
A previous analysis of a different subset of the remote sensing data set we used made projections of sagebrush decline in the future [@Homer2015].
The discrepancy between Homer et al.'s (2015) results and ours reflects a differences in the climate projections used for forecasting future changes rather than differences in our inference about how climate drives sagebrush cover change.
The Homer et al. (2015) study also found a generally positive relationship between pixel-level sagebrush cover and precipitation, but the climate scenario they chose resulted in a mean decrease in precipitation.
Thus, the decline in precipitation led to a decline in sagebrush cover.
Our current work shows that when multiple climate projections are considered, on average sagebrush cover is forecast to increase, but decreases are not outside the realm of our forecasts when all sources of uncertainty are considered (Fig. 5).

(not sure this next paragraph is needed--it also sounds a bit too prescriptive about climate projection which is probably outside the realm of the paper) 
There is no clear answer to what climate model to use when making ecological forecasts. Much like weather forecasters [@Bauer2015], ecological forecasters may need to apply expert judgement to choose climate projections.
If a certain GCM tends to better predict weather in a specific study area, then that GCM may be given more weight than others.

Several *a priori* modeling decisions determined the spatial extent and resolution of our results. 
We focused the native spatial resolution of the remote sensing data ($30\times30$ meters). 
This constrained the extent that we could reasonably model because of the computational challenges in using a massive spatial random effect. 
Even with our dimension reduction technique modeling a larger area at this resolution would require a greater number of spatial knots, and computation time would increase substantially [@Wikle2010].
In order to overcome this, future investigators modeling a larger spatial extent may need to aggregate their original remote-sensing time series data to a coarse spatial resoluation.  This would allow them to model a much greater spatial extent with a similar number of knots and a similar amount of computation time.  A coarser scale model would lose some fine-scale detail but could be applied to a much larger area, potentially gaining some strength in estimating climate effects by spanning a greater range of climate variation.  

Our spatial extent and resolution also impacted our incorporation of climate covariates.
We did not downscale Daymet data to match the spatial resolution of the sagebrush data.
Thus, in each year all pixels share the same climate covariates.
This is a potential limitation of our study, and could explain the weak effect of climate covariates that we observed (Fig. 3).
Future studies could examine lower spatial resolutions and larger spatial extents to facilitate the use of spatially-explicit climate covariates that match the resolution of the percent cover data.
It would also be possible to include relevant abiotic data layers as predictors when fitting models at larger spatial extents where variation in spatial covariates like soil type, slope, and aspect may play important roles.

Conclusion
----------
We have introduced a new approach to fitting and simulating population models at large spatial extents.
As methodological and conceptual advancements are made we will be able to apply our approach over even larger spatial extents, and at higher spatial resolution.
Working at large spatial extents, it will become feasible to use spatially-explicit weather data products to fit and simulate the models.
Given the dependence of forecasts on the weather projections used, we urge ecologists to adopt methods from weather forecasters to up- and down-weight GCMs based on study area-specific reliability.
Lastly, it may also be important to include the effects of species interactions [@Clark2014].
Fortunately, our spatio-temporal modeling framework is very flexible.
It can be used for any spatially-explicit time series of species-specific estimates of plant cover or density.
The core process model (Eq. 2) can take any form; meaning that additional covariates can easily be included or an entirely different functional form can be used depending on the ecological context.
As large scale time series data sets become more available, we anticipate the approach we developed here to fill the gap in spatial scales between species distribution models and local-scale demographic population models.


Acknowledgments
---------------
This work is the outcome of a distributed graduate seminar led by PBA and supported by a National Science Foundation CAREER award (DEB-1054040). ATT was supported by an NSF Postdoctoral Research Fellowship in Biology (DBI-1400370) and AK was supported by an NSF Graduate Research Fellowship. Additional support came from the Utah Agricultural Experiment Station, Utah State University, and this article is approved as journal paper number XXXX. We are grateful to Debra K. Meyer at USGS EROS for exctracting the data set used in this paper. Compute, storage and other resources from the Division of Research Computing in the Office of Research and Graduate Studies at Utah State University are gratefully acknowledged. We acknowledge the World Climate Research Programme's Working Group on Coupled Modelling, which is responsible for CMIP, and we thank the climate modeling groups (listed in Table X1) for producing and making available their model output. For CMIP the U.S. Department of Energy's Program for Climate Model Diagnosis and Intercomparison provides coordinating support and led development of software infrastructure in partnership with the Global Organization for Earth System Science Portals. Any use of trade, firm, or product names is for descriptive purposes only and does not imply endorsement by the U.S. government. David T. Iles, Eric LaMalfa, and Rebecca Mann participated in project conception as part of the distributed graduate seminar and provided comments that improved the manuscript.

\pagebreak{}

Tables
------
\begin{table}[h]
\protect\caption{\label{tab:Changes-in-climate}Projected changes in temperature and precipitation at our study area from CMIP5 average GCM projections for 2050-2100 relative to average temperature and precipitation from 1950-2000.}
\begin{tabular}{llllll}
\hline
Emissions Scenario & Absolute change in temperature & Percentage change in precipitation\tabularnewline
\hline
RCP 4.5 & 2.98\textdegree & 8.94\%\tabularnewline
RCP 6.0 & 3.13\textdegree & 8.64\%\tabularnewline
RCP 8.5 & 4.79\textdegree & 11.0\%\tabularnewline
\hline
\end{tabular}
\end{table}

\pagebreak{}

Figures
-------
```{r figure_1_alt,dependson="plot-options", fig.cap="Location of the 2.5 $\\times$ 5 kilometer study area in southwestern Wyoming and a snapshot of the percent cover data in 1984.", fig.height=6, eval=F}
library(png)
library(grid)
img <- readPNG("components/figure/studyarea_map.png")
grid.raster(img)
```


```{r figure_1,dependson="plot-options", fig.cap="Percent cover in space and time for our study area in southwestern Wyoming.", eval=F}
library(png)
library(grid)
img <- readPNG("../results/all_years_percCover.png")
grid.raster(img)
```

```{r figure_2a,dependson="plot-options", fig.cap="GCM yearly weather hindcasts (before solid line at 2011) and projections (after solid line at 2011) for precipitation (A) and temperature (B) at our study area.", eval=F}
library(png)
library(grid)
img <- readPNG("components/figure/weather_projections.png")
grid.raster(img)
```

```{r figure_2,dependson="plot-options", fig.cap="Posterior distributions of climate covariates. The x-axis is the standardized coefficient value because we fit the model using standardized covariate values. Only cumulative precipitation at time \\emph{t} is important (shown in dark grey; 90% CI does not overlap zero).", fig.height=4, eval=F}
library(png)
library(grid)
img <- readPNG("../results/post_climate_covariates.png")
grid.raster(img)
```


```{r figure_3,dependson="plot-options", fig.cap="Standardized percent cover showing the general spatial structure of above and below average pixels in the data (top panel) compared to the mean posterior estimate of the spatial field, $\\eta$ (bottom panel).", eval=F}
library(png)
library(grid)
img <- readPNG("../results/spatialfield.png")
grid.raster(img)
```

```{r figure_4,dependson="plot-options", fig.cap="Observed and predicted (A, B) equilibrium percent cover, and prediction bias and standard deviation (C, D). All simulations used mean parameter values and no random year effects.", fig.height=8, eval=F}
library(png)
library(grid)
img <- readPNG("../results/obs_pred_spatial_subset.png")
grid.raster(img)
```

```{r figure_5,dependson="plot-options", fig.cap="Histograms of projected equilibrium cover from simulations using observed climate (orange) and average observed percent cover (black).", eval=F}
library(png)
library(grid)
img <- readPNG("../results/obs_pred_hist.png")
grid.raster(img)
```

```{r figure_6,dependson="plot-options", fig.cap="Projected equilibrium cover under climate change scenarios. Top panels shows equilibrium cover based on simulations using observed cliamte. Subsequent panels show equilibrium cover based on perturbed climate for each RCP scenario. Forecasts are based on the projected climate changes in Table 1 applied to the observed climate time series used to fit the model. We used mean parameter estimates.", fig.height=8, eval=F}
library(png)
library(grid)
img <- readPNG("../results/clim_change_mean_spatial.png")
grid.raster(img)
```

```{r figure_7,dependson="plot-options", fig.cap="Estimated kernel densities for current and projected sagebrush cover across space and simulation time.", eval=F}
library(png)
library(grid)
img <- readPNG("../results/clim_change_densities.png")
grid.raster(img)
```

```{r figure_8,dependson="plot-options", fig.cap="Model forecasts under future climate for three IPCC emissions scenarios. Shaded regions show 90% quantiles for simulations conducted using 50 different sets of parameters from the MCMC output. Lines show mean trajectories. Uncertainty in forecasts arises from uncertainty in GCM projections, uncerainty around the ecological process, and uncertainty around parameter estimates. Before calculating the mean and 90% quantiles for each year across parameter sets and GCMs, we averaged percent cover over the 13,689 pixles.", eval=F}
library(png)
library(grid)
img <- readPNG("../results/temporal_forecast.png")
grid.raster(img)
```

\pagebreak{}

References
----------
